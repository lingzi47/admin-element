{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\lun-vue-admin-master\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\lun-vue-admin-master\\src\\permission.js","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\lun-vue-admin-master\\src\\permission.js","mtime":1646805521000},{"path":"C:\\Users\\Administrator\\Desktop\\lun-vue-admin-master\\babel.config.js","mtime":1646805521000},{"path":"C:\\Users\\Administrator\\Desktop\\lun-vue-admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\lun-vue-admin-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovVXNlcnMvQWRtaW5pc3RyYXRvci9EZXNrdG9wL2x1bi12dWUtYWRtaW4tbWFzdGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKCi8qKgogKiDot6/nlLHlrojljavvvIzliqjmgIHmt7vliqDot6/nlLEKICovCmltcG9ydCByb3V0ZXIgZnJvbSAnLi9yb3V0ZXInOwppbXBvcnQgc3RvcmUgZnJvbSAnLi9zdG9yZSc7CmltcG9ydCBOUHJvZ3Jlc3MgZnJvbSAnbnByb2dyZXNzJzsgLy8gUHJvZ3Jlc3Mg6L+b5bqm5p2hCgppbXBvcnQgJ25wcm9ncmVzcy9ucHJvZ3Jlc3MuY3NzJzsKaW1wb3J0IHsgTWVzc2FnZSB9IGZyb20gJ2VsZW1lbnQtdWknOwp2YXIgd2hpdGVMaXN0ID0gWycvbG9naW4nXTsgLy8g55m95ZCN5Y2VCgpOUHJvZ3Jlc3MuY29uZmlndXJlKHsKICBzaG93U3Bpbm5lcjogZmFsc2UKfSk7CnJvdXRlci5iZWZvcmVFYWNoKGZ1bmN0aW9uICh0bywgZnJvbSwgbmV4dCkgewogIE5Qcm9ncmVzcy5zdGFydCgpOyAvLyDliqDovb3ov5vluqbmnaEKCiAgZG9jdW1lbnQudGl0bGUgPSAndnVlMuWQjuWPsOeuoeeQhuezu+e7nyc7CiAgdmFyIGhhc1Rva2VuID0gc3RvcmUuZ2V0dGVycy50b2tlbjsKCiAgaWYgKGhhc1Rva2VuKSB7CiAgICBpZiAodG8ucGF0aCA9PT0gJy9sb2dpbicpIHsKICAgICAgbmV4dCh7CiAgICAgICAgcGF0aDogJy8nCiAgICAgIH0pOwogICAgICBOUHJvZ3Jlc3MuZG9uZSgpOwogICAgfSBlbHNlIHsKICAgICAgdmFyIGhhc1JvbGVzID0gc3RvcmUuZ2V0dGVycy51c2VySW5mby5yb2xlczsKCiAgICAgIGlmICghaGFzUm9sZXMgfHwgaGFzUm9sZXMubGVuZ3RoID09IDApIHsKICAgICAgICBzdG9yZS5kaXNwYXRjaCgndXNlci9nZXRVc2VySW5mbycpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgdmFyIGRhdGEgPSByZXMuZGF0YTsKICAgICAgICAgIHN0b3JlLmRpc3BhdGNoKCdyb3V0ZXMvZ2VuZXJhdGVSb3V0ZXMnLCB7CiAgICAgICAgICAgICdyb2xlcyc6IGRhdGEucm9sZXMKICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvLyDmoLnmja5yb2xlc+adg+mZkOeUn+aIkOWPr+iuv+mXrueahOi3r+eUseihqAogICAgICAgICAgICByb3V0ZXIuYWRkUm91dGVzKHN0b3JlLmdldHRlcnMuYWRkUm91dGVycyk7IC8vIOWKqOaAgea3u+WKoOWPr+iuv+mXruadg+mZkOi3r+eUseihqAoKICAgICAgICAgICAgbmV4dChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRvKSwge30sIHsKICAgICAgICAgICAgICByZXBsYWNlOiB0cnVlCiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgc3RvcmUuZGlzcGF0Y2goJ3VzZXIvbG9nb3V0JykudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIE1lc3NhZ2UuZXJyb3IoZXJyb3IgfHwgIumqjOivgeWksei0pe+8jOivt+mHjeaWsOeZu+W9lSIpOwogICAgICAgICAgICBuZXh0KHsKICAgICAgICAgICAgICBwYXRoOiAnLycKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBuZXh0KCk7CiAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgfQogICAgfQogIH0gZWxzZSB7CiAgICBpZiAod2hpdGVMaXN0LmluZGV4T2YodG8ucGF0aCkgIT09IC0xKSB7CiAgICAgIC8vIOeCueWHu+mAgOWHuuaXtizkvJrlrprkvY3liLDov5nph4wKICAgICAgbmV4dCgpOwogICAgfSBlbHNlIHsKICAgICAgbmV4dCgiL2xvZ2luIik7CiAgICAgIE5Qcm9ncmVzcy5kb25lKCk7CiAgICB9CiAgfQp9KTsKcm91dGVyLmFmdGVyRWFjaChmdW5jdGlvbiAoKSB7CiAgTlByb2dyZXNzLmRvbmUoKTsgLy8g57uT5p2fUHJvZ3Jlc3MKfSk7"},{"version":3,"sources":["C:/Users/Administrator/Desktop/lun-vue-admin-master/src/permission.js"],"names":["router","store","NProgress","Message","whiteList","configure","showSpinner","beforeEach","to","from","next","start","document","title","hasToken","getters","token","path","done","hasRoles","userInfo","roles","length","dispatch","then","res","data","addRoutes","addRouters","replace","catch","error","indexOf","afterEach"],"mappings":";;AAAA;AACA;AACA;AAEA,OAAOA,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,SAAP,MAAsB,WAAtB,C,CAAkC;;AAClC,OAAO,yBAAP;AACA,SAASC,OAAT,QAAwB,YAAxB;AAEA,IAAMC,SAAS,GAAG,CAAC,QAAD,CAAlB,C,CAA8B;;AAC9BF,SAAS,CAACG,SAAV,CAAoB;AAAEC,EAAAA,WAAW,EAAE;AAAf,CAApB;AAEAN,MAAM,CAACO,UAAP,CAAkB,UAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAoB;AACrCR,EAAAA,SAAS,CAACS,KAAV,GADqC,CACnB;;AAClBC,EAAAA,QAAQ,CAACC,KAAT,GAAiB,YAAjB;AAEA,MAAMC,QAAQ,GAAGb,KAAK,CAACc,OAAN,CAAcC,KAA/B;;AACA,MAAIF,QAAJ,EAAc;AACb,QAAIN,EAAE,CAACS,IAAH,KAAY,QAAhB,EAA0B;AACzBP,MAAAA,IAAI,CAAC;AAAEO,QAAAA,IAAI,EAAE;AAAR,OAAD,CAAJ;AACAf,MAAAA,SAAS,CAACgB,IAAV;AACA,KAHD,MAGO;AACN,UAAMC,QAAQ,GAAGlB,KAAK,CAACc,OAAN,CAAcK,QAAd,CAAuBC,KAAxC;;AACA,UAAI,CAACF,QAAD,IAAaA,QAAQ,CAACG,MAAT,IAAmB,CAApC,EAAuC;AACtCrB,QAAAA,KAAK,CAACsB,QAAN,CAAe,kBAAf,EAAmCC,IAAnC,CAAwC,UAAAC,GAAG,EAAI;AAC9C,cAAQC,IAAR,GAAiBD,GAAjB,CAAQC,IAAR;AACAzB,UAAAA,KAAK,CAACsB,QAAN,CAAe,uBAAf,EAAwC;AACvC,qBAASG,IAAI,CAACL;AADyB,WAAxC,EAEGG,IAFH,CAEQ,YAAM;AACb;AACAxB,YAAAA,MAAM,CAAC2B,SAAP,CAAiB1B,KAAK,CAACc,OAAN,CAAca,UAA/B,EAFa,CAE8B;;AAC3ClB,YAAAA,IAAI,iCACAF,EADA;AAEHqB,cAAAA,OAAO,EAAE;AAFN,eAAJ;AAIA,WATD;AAUA,SAZD,EAYGC,KAZH,CAYS,UAAAC,KAAK,EAAI;AACjB9B,UAAAA,KAAK,CAACsB,QAAN,CAAe,aAAf,EAA8BC,IAA9B,CAAmC,YAAM;AACxCrB,YAAAA,OAAO,CAAC4B,KAAR,CAAcA,KAAK,IAAI,YAAvB;AACArB,YAAAA,IAAI,CAAC;AAAEO,cAAAA,IAAI,EAAE;AAAR,aAAD,CAAJ;AACA,WAHD;AAIA,SAjBD;AAkBA,OAnBD,MAmBO;AACNP,QAAAA,IAAI;AACJR,QAAAA,SAAS,CAACgB,IAAV;AACA;AACD;AACD,GA9BD,MA8BO;AACN,QAAId,SAAS,CAAC4B,OAAV,CAAkBxB,EAAE,CAACS,IAArB,MAA+B,CAAC,CAApC,EAAuC;AACtC;AACAP,MAAAA,IAAI;AACJ,KAHD,MAGO;AACNA,MAAAA,IAAI,UAAJ;AACAR,MAAAA,SAAS,CAACgB,IAAV;AACA;AACD;AACD,CA5CD;AA8CAlB,MAAM,CAACiC,SAAP,CAAiB,YAAM;AACtB/B,EAAAA,SAAS,CAACgB,IAAV,GADsB,CACL;AACjB,CAFD","sourcesContent":["/**\n * 路由守卫，动态添加路由\n */\n\nimport router from './router'\nimport store from './store'\nimport NProgress from 'nprogress' // Progress 进度条\nimport 'nprogress/nprogress.css'\nimport { Message } from 'element-ui'\n\nconst whiteList = ['/login']; // 白名单\nNProgress.configure({ showSpinner: false })\n\nrouter.beforeEach((to, from, next) => {\n\tNProgress.start() // 加载进度条\n\tdocument.title = 'vue2后台管理系统'\n\n\tconst hasToken = store.getters.token;\n\tif (hasToken) {\n\t\tif (to.path === '/login') {\n\t\t\tnext({ path: '/' })\n\t\t\tNProgress.done()\n\t\t} else {\n\t\t\tconst hasRoles = store.getters.userInfo.roles;\n\t\t\tif (!hasRoles || hasRoles.length == 0) {\n\t\t\t\tstore.dispatch('user/getUserInfo').then(res => {\n\t\t\t\t\tconst { data } = res;\n\t\t\t\t\tstore.dispatch('routes/generateRoutes', {\n\t\t\t\t\t\t'roles': data.roles\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\t// 根据roles权限生成可访问的路由表\n\t\t\t\t\t\trouter.addRoutes(store.getters.addRouters) // 动态添加可访问权限路由表\n\t\t\t\t\t\tnext({\n\t\t\t\t\t\t\t...to,\n\t\t\t\t\t\t\treplace: true\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tstore.dispatch('user/logout').then(() => {\n\t\t\t\t\t\tMessage.error(error || \"验证失败，请重新登录\")\n\t\t\t\t\t\tnext({ path: '/' })\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tnext()\n\t\t\t\tNProgress.done()\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (whiteList.indexOf(to.path) !== -1) {\n\t\t\t// 点击退出时,会定位到这里\n\t\t\tnext()\n\t\t} else {\n\t\t\tnext(`/login`)\n\t\t\tNProgress.done()\n\t\t}\n\t}\n})\n\nrouter.afterEach(() => {\n\tNProgress.done() // 结束Progress\n})\n"]}]}