{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\后台\\src\\views\\user\\powermanage\\bguserlist\\components\\setRole.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\后台\\src\\views\\user\\powermanage\\bguserlist\\components\\setRole.vue","mtime":1670292844205},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1lbnVMaXN0LCBhZGRVc2VybWVudSwgVXNlcm1lbnVzaG93IH0gZnJvbSAiQC9yZXF1ZXN0L2FwaSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAic2V0Um9sZSIsCiAgY29tcG9uZW50czoge30sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlkOiAiIiwKICAgICAgbV9pZDogIiIsCiAgICAgIHFfaWQ6ICIiLAogICAgICBkZWZhdWx0UHJvcHM6IHsKICAgICAgICBjaGlsZHJlbjogImNoaWxkcmVuIiwKICAgICAgICBsYWJlbDogIm1fbmFtZSIsCiAgICAgIH0sCiAgICAgIGRyYXdlcjogZmFsc2UsCiAgICAgIHJvbGVJbmZvOiB7fSwKICAgICAgdHJlZU1lbnU6IFtdLAogICAgICBtaWRhcnI6IFtdLAogICAgICB0cmVlQ2hlY2tlZEtleXM6IFtdLAogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7fSwKICBtb3VudGVkKCkge30sCiAgbWV0aG9kczogewogICAgZ2V0Tm9kZSh0cmVlTWVudSkge30sCiAgICBzaG93KHJvdykgewogICAgICB0aGlzLnJvbGVJbmZvID0gcm93OwogICAgICB0aGlzLmlkID0gcm93LmlkOwogICAgICB0aGlzLmdldE1lbnVPcGVyYXRlKCk7CiAgICAgIHRoaXMuVXNlcm1lbnVzaG93KCk7CiAgICB9LAoKICAgIGNsb3NlKCkgewogICAgICB0aGlzLiRyZWZzLm1lbnVUcmVlLnNldENoZWNrZWRLZXlzKFtdKTsKICAgIH0sCiAgICBVc2VybWVudXNob3coKSB7CiAgICAgIC8vIHRoaXMudHJlZUNoZWNrZWRLZXlzID0gWyIzNCIsICIzNSJdOwogICAgICBsZXQgaWQgPSB0aGlzLmlkOwogICAgICBsZXQgcGFyYW1zID0gewogICAgICAgIHRva2VuOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpLAogICAgICB9OwogICAgICBVc2VybWVudXNob3cocGFyYW1zLCBpZCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy50cmVlQ2hlY2tlZEtleXMgPSByZXMuZGF0YS5kYXRhLnFfaWQuc3BsaXQoIiwiKTsKICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnRyZWVDaGVja2VkS2V5cywgInRyZWVDaGVja2VkS2V5cyIpOwogICAgICAgIC8vIGxldCBtaWQgPSByZXMuZGF0YS5kYXRhLm1faWQ7CiAgICAgICAgLy8gdGhpcy5taWRhcnIucHVzaChtaWQpOwogICAgICAgIC8vIC8v5ZCO56uv6L+U5Zue55qE5omA5pyJaWQKICAgICAgICAvLyB2YXIgdGhhdCA9IHRoaXM7CiAgICAgICAgLy8gdGhpcy5taWRhcnIuZm9yRWFjaCgoaSwgbikgPT4gewogICAgICAgIC8vICAgdmFyIG5vZGUgPSB0aGF0LiRyZWZzLm1lbnVUcmVlLmdldE5vZGUoaSk7CiAgICAgICAgLy8gICBpZiAobm9kZS5pc0xlYWYpIHsKICAgICAgICAvLyAgICAgdGhhdC4kcmVmcy5tZW51VHJlZS5zZXRDaGVja2VkKG5vZGUsIHRydWUpOwogICAgICAgIC8vICAgfQogICAgICAgIC8vIH0pOwogICAgICB9KTsKICAgIH0sCgogICAgY2hhbmdlUm9sZSgpIHsKICAgICAgbGV0IGlkID0gdGhpcy5pZDsKICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICB0b2tlbjogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKSwKICAgICAgICBtX2lkOiB0aGlzLm1faWQsCiAgICAgICAgcV9pZDogdGhpcy5xX2lkLAogICAgICB9OwogICAgICBhZGRVc2VybWVudShwYXJhbXMsIGlkKS50aGVuKChyZXMpID0+IHsKICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5p2D6ZmQ6K6+572u5oiQ5YqfIik7CiAgICAgICAgICB0aGlzLmRyYXdlciA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIGdldE1lbnVPcGVyYXRlKCkgewogICAgICBsZXQgcGFyYW1zID0gewogICAgICAgIHRva2VuOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpLAogICAgICB9OwogICAgICBtZW51TGlzdChwYXJhbXMpLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMudHJlZU1lbnUgPSByZXMuZGF0YS5kYXRhOwogICAgICAgIHRoaXMuZHJhd2VyID0gdHJ1ZTsKICAgICAgfSk7CiAgICB9LAoKICAgIC8vIOiKgueCueiiq+eCueWHuwogICAgY2hlY2tDaGFuZ2UoZGF0YSwgY2hlY2tlZCkgewogICAgICBsZXQgdHJlZWRhdGEgPSB0aGlzLiRyZWZzLm1lbnVUcmVlCiAgICAgICAgLmdldENoZWNrZWROb2RlcygpCiAgICAgICAgLmNvbmNhdCh0aGlzLiRyZWZzLm1lbnVUcmVlLmdldEhhbGZDaGVja2VkTm9kZXMoKSk7CiAgICAgIGNvbnNvbGUubG9nKHRyZWVkYXRhLCAi5YWo6YOo5pWw5o2uIik7CiAgICAgIGxldCB0cmVlZGF0YTEgPSB0aGlzLiRyZWZzLm1lbnVUcmVlLmdldENoZWNrZWROb2RlcygpOwogICAgICBjb25zb2xlLmxvZyh0cmVlZGF0YTEsICLlhajpgInkuK0iKTsKICAgICAgbGV0IGFycm5ldyA9IHRyZWVkYXRhCiAgICAgICAgLm1hcCgob2JqLCBpbmRleCkgPT4gewogICAgICAgICAgcmV0dXJuIG9iai5pZDsKICAgICAgICB9KQogICAgICAgIC5qb2luKCIsIikKICAgICAgICAuc3BsaXQoIiwiKTsKICAgICAgdmFyIG1faWQgPSBhcnJuZXcudG9TdHJpbmcoKTsKICAgICAgdGhpcy5tX2lkID0gbV9pZDsKICAgICAgY29uc29sZS5sb2codGhpcy5tX2lkLCAi5YWo6YOoaWQiKTsKICAgICAgLy8g5YWo6YCJ5LitCiAgICAgIGxldCBhcnJuZXcxID0gdHJlZWRhdGExCiAgICAgICAgLm1hcCgob2JqLCBpbmRleCkgPT4gewogICAgICAgICAgcmV0dXJuIG9iai5pZDsKICAgICAgICB9KQogICAgICAgIC5qb2luKCIsIikKICAgICAgICAuc3BsaXQoIiwiKTsKICAgICAgdmFyIHFfaWQgPSBhcnJuZXcxLnRvU3RyaW5nKCk7CiAgICAgIHRoaXMucV9pZCA9IHFfaWQ7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMucV9pZCwgIuWFqOmAieS4rWlkIik7CiAgICAgIC8vIGxldCBjaGVja2VkS2V5ID0gdGhpcy4kcmVmcy5tZW51VHJlZS5nZXRDaGVja2VkS2V5cygpOwogICAgICAvLyBpZiAoY2hlY2tlZCkgewogICAgICAvLyAgIGxldCBzZWFyY2hJZCA9IGRhdGEuaWQ7CiAgICAgIC8vICAgaWYgKGNoZWNrZWRLZXkuaW5kZXhPZihzZWFyY2hJZCkgPT0gLTEpIHsKICAgICAgLy8gICAgIGNoZWNrZWRLZXkucHVzaChzZWFyY2hJZCk7CiAgICAgIC8vICAgICB0aGlzLiRyZWZzLm1lbnVUcmVlLnNldENoZWNrZWRLZXlzKGNoZWNrZWRLZXkpOwogICAgICAvLyAgIH0KICAgICAgLy8gfQogICAgICAvLyBlbHNlIHsKICAgICAgLy8gICBsZXQgc2VhcmNoUGFySWQgPSBkYXRhLmlkOwogICAgICAvLyAgIC8vIGNoZWNrZWRLZXkubWFwKChpdGVtKSA9PiB7CiAgICAgIC8vICAgLy8gICBpZiAoaXRlbS5zdWJzdHJpbmcoMCwgNSkgPT0gc2VhcmNoUGFySWQpIHNlYXJjaFBhckZsYWcgPSB0cnVlOwogICAgICAvLyAgIC8vIH0pOwogICAgICAvLyB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["setRole.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"setRole.vue","sourceRoot":"src/views/user/powermanage/bguserlist/components","sourcesContent":["<template>\n  <div class=\"setRole\">\n    <el-drawer\n      title=\"角色权限设置\"\n      :visible.sync=\"drawer\"\n      direction=\"rtl\"\n      @closed=\"close\"\n      :size=\"1600\"\n    >\n      <div class=\"clearflex\">\n        <el-button type=\"primary\" @click=\"changeRole\">确 定</el-button>\n      </div>\n      <el-scrollbar style=\"height: calc(100% - 40px)\">\n        <div class=\"tree-menu\">\n          <el-tree\n            ref=\"menuTree\"\n            :data=\"treeMenu\"\n            :props=\"defaultProps\"\n            show-checkbox\n            :default-expand-all=\"true\"\n            node-key=\"id\"\n            :default-checked-keys=\"treeCheckedKeys\"\n            @check-change=\"checkChange\"\n            @click=\"getNode\"\n          ></el-tree>\n        </div>\n      </el-scrollbar>\n    </el-drawer>\n  </div>\n</template>\n\n<script>\nimport { menuList, addUsermenu, Usermenushow } from \"@/request/api\";\nexport default {\n  name: \"setRole\",\n  components: {},\n  data() {\n    return {\n      id: \"\",\n      m_id: \"\",\n      q_id: \"\",\n      defaultProps: {\n        children: \"children\",\n        label: \"m_name\",\n      },\n      drawer: false,\n      roleInfo: {},\n      treeMenu: [],\n      midarr: [],\n      treeCheckedKeys: [],\n    };\n  },\n  created() {},\n  mounted() {},\n  methods: {\n    getNode(treeMenu) {},\n    show(row) {\n      this.roleInfo = row;\n      this.id = row.id;\n      this.getMenuOperate();\n      this.Usermenushow();\n    },\n\n    close() {\n      this.$refs.menuTree.setCheckedKeys([]);\n    },\n    Usermenushow() {\n      // this.treeCheckedKeys = [\"34\", \"35\"];\n      let id = this.id;\n      let params = {\n        token: sessionStorage.getItem(\"token\"),\n      };\n      Usermenushow(params, id).then((res) => {\n        this.treeCheckedKeys = res.data.data.q_id.split(\",\");\n        console.log(this.treeCheckedKeys, \"treeCheckedKeys\");\n        // let mid = res.data.data.m_id;\n        // this.midarr.push(mid);\n        // //后端返回的所有id\n        // var that = this;\n        // this.midarr.forEach((i, n) => {\n        //   var node = that.$refs.menuTree.getNode(i);\n        //   if (node.isLeaf) {\n        //     that.$refs.menuTree.setChecked(node, true);\n        //   }\n        // });\n      });\n    },\n\n    changeRole() {\n      let id = this.id;\n      let params = {\n        token: sessionStorage.getItem(\"token\"),\n        m_id: this.m_id,\n        q_id: this.q_id,\n      };\n      addUsermenu(params, id).then((res) => {\n        if (res.status == 200) {\n          this.$message.success(\"权限设置成功\");\n          this.drawer = false;\n        }\n      });\n    },\n\n    getMenuOperate() {\n      let params = {\n        token: sessionStorage.getItem(\"token\"),\n      };\n      menuList(params).then((res) => {\n        this.treeMenu = res.data.data;\n        this.drawer = true;\n      });\n    },\n\n    // 节点被点击\n    checkChange(data, checked) {\n      let treedata = this.$refs.menuTree\n        .getCheckedNodes()\n        .concat(this.$refs.menuTree.getHalfCheckedNodes());\n      console.log(treedata, \"全部数据\");\n      let treedata1 = this.$refs.menuTree.getCheckedNodes();\n      console.log(treedata1, \"全选中\");\n      let arrnew = treedata\n        .map((obj, index) => {\n          return obj.id;\n        })\n        .join(\",\")\n        .split(\",\");\n      var m_id = arrnew.toString();\n      this.m_id = m_id;\n      console.log(this.m_id, \"全部id\");\n      // 全选中\n      let arrnew1 = treedata1\n        .map((obj, index) => {\n          return obj.id;\n        })\n        .join(\",\")\n        .split(\",\");\n      var q_id = arrnew1.toString();\n      this.q_id = q_id;\n      console.log(this.q_id, \"全选中id\");\n      // let checkedKey = this.$refs.menuTree.getCheckedKeys();\n      // if (checked) {\n      //   let searchId = data.id;\n      //   if (checkedKey.indexOf(searchId) == -1) {\n      //     checkedKey.push(searchId);\n      //     this.$refs.menuTree.setCheckedKeys(checkedKey);\n      //   }\n      // }\n      // else {\n      //   let searchParId = data.id;\n      //   // checkedKey.map((item) => {\n      //   //   if (item.substring(0, 5) == searchParId) searchParFlag = true;\n      //   // });\n      // }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n::v-deep {\n  .el-drawer__body {\n    overflow: auto;\n    overflow-y: hidden;\n  }\n  .el-scrollbar__wrap {\n    overflow-x: hidden;\n  }\n}\n.clearflex {\n  padding: 0 20px;\n  *zoom: 1;\n  text-align: right;\n}\n/deep/ .tree-menu {\n  padding: 20px;\n\n  .custom-tree-node {\n    display: flex;\n    justify-content: space-between;\n    width: 100%;\n    .menu-role {\n      flex: 1;\n      text-align: right;\n    }\n  }\n  .el-tree {\n    .el-tree-node__children {\n      .el-tree-node__children {\n        padding-left: 40px;\n        .el-tree-node {\n          display: inline-block;\n          .el-tree-node__content {\n            padding: 0 20px 0 0 !important;\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n"]}]}