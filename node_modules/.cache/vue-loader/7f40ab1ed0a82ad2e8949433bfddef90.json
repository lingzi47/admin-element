{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\后台\\src\\views\\basis\\countDown\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\后台\\src\\views\\basis\\countDown\\index.vue","mtime":1646805521000},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\后台\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiY291bnREb3duIiwKICBjb21wb25lbnRzOiB7CgogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGFkZERhdGU6ICIiLAogICAgICBub3dEYXRlOiAiIiwKICAgICAgcGlja2VyT3B0aW9uczogewogICAgICAgIGRpc2FibGVkRGF0ZShkYXRlKSB7CiAgICAgICAgICByZXR1cm4gZGF0ZS5nZXRUaW1lKCkgPCBEYXRlLm5vdygpIC0gMjQgKiA2MCAqIDYwICogMTAwMCB8fCBkYXRlLmdldFRpbWUoKSA+IERhdGUubm93KCkgKyAzMCAqIDI0ICogNjAgKiA2MCAqIDEwMDAKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRhdGVUaW1lOiBbewogICAgICAgIGVuZERhdGVUaW1lOiAiMjAyMy0wMS0yMiAwMDowMDowMCIsCiAgICAgICAgY291bnREb3duOiB7IGRheXM6ICIwIiwgaG91cnM6ICIwMCIsIG1pbnM6ICIwMCIsIHNlY29uZHM6ICIwMCIsIH0sCiAgICAgICAgdGltZXI6IG51bGwsCiAgICAgICAgaXNPdmVyOiBmYWxzZSwKICAgICAgICBjdXJUaW1lOiAwLAogICAgICB9XSwKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7IH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuY291bnREb3duKCk7CiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgIGxldCBuZCA9IG5ldyBEYXRlKCk7CiAgICAgIGxldCB5ID0gbmQuZ2V0RnVsbFllYXIoKTsKICAgICAgbGV0IG0gPSBgMDAke25kLmdldE1vbnRoKCkgKyAxfWAuc2xpY2UoLTIpOwogICAgICBsZXQgZCA9IGAwMCR7bmQuZ2V0RGF0ZSgpfWAuc2xpY2UoLTIpOwogICAgICBsZXQgaCA9IGAwMCR7bmQuZ2V0SG91cnMoKX1gLnNsaWNlKC0yKTsKICAgICAgbGV0IG1zID0gYDAwJHtuZC5nZXRNaW51dGVzKCl9YC5zbGljZSgtMik7CiAgICAgIGxldCBzID0gYDAwJHtuZC5nZXRTZWNvbmRzKCl9YC5zbGljZSgtMik7CiAgICAgIHRoaXMubm93RGF0ZSA9IHkgKyAiLSIgKyBtICsgIi0iICsgZCArICIgIiArIGggKyAiOiIgKyBtcyArICI6IiArIHMKICAgIH0sIDEwMDApOwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHNldFRpbWVyQ2xhc3MoKSB7CiAgICAgIHJldHVybiAoZHQpID0+IHsKICAgICAgICBsZXQgZHRDbGFzcyA9ICcnOwogICAgICAgIGlmICghZHQuY291bnREb3duLmRheXMgJiYgIWR0LmNvdW50RG93bi5ob3VycyAmJiAhZHQuY291bnREb3duLm1pbnMgJiYgIWR0LmNvdW50RG93bi5zZWNvbmRzKSBkdENsYXNzID0gJ2R0LW92ZXInOwogICAgICAgIGVsc2UgaWYgKCFkdC5jb3VudERvd24uZGF5cyAmJiAhZHQuY291bnREb3duLmhvdXJzICYmICFkdC5jb3VudERvd24ubWlucyAmJiBkdC5jb3VudERvd24uc2Vjb25kcykgZHRDbGFzcyA9ICdtaW5zLW92ZXInOwogICAgICAgIGVsc2UgaWYgKCFkdC5jb3VudERvd24uZGF5cyAmJiAhZHQuY291bnREb3duLmhvdXJzICYmIChkdC5jb3VudERvd24ubWlucyB8fCBkdC5jb3VudERvd24uc2Vjb25kcykpIGR0Q2xhc3MgPSAnaG91cnMtb3Zlcic7CiAgICAgICAgZWxzZSBpZiAoIWR0LmNvdW50RG93bi5kYXlzICYmIChkdC5jb3VudERvd24uaG91cnMgfHwgZHQuY291bnREb3duLm1pbnMgfHwgZHQuY291bnREb3duLnNlY29uZHMpKSBkdENsYXNzID0gJ2RheXMtb3Zlcic7CiAgICAgICAgcmV0dXJuIGR0Q2xhc3M7CiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGFkZERhdGV0aW1lKCkgewogICAgICBpZiAoIXRoaXMuYWRkRGF0ZSkgcmV0dXJuCiAgICAgIGxldCBzZWxEdCA9IG5ldyBEYXRlKHRoaXMuYWRkRGF0ZSkuZm9ybWF0KCJ5eXl5LU1NLWRkIEhIOm1tOnNzIikKICAgICAgaWYgKChuZXcgRGF0ZShzZWxEdCkuZ2V0VGltZSgpKSAtIChEYXRlLm5vdygpKSA8IDMwMDAwKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCLlgJLorqHml7bml7bpl7TkuI3og73lsI/kuo4gMzAg56eSIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuZGF0ZVRpbWUucHVzaCh7CiAgICAgICAgZW5kRGF0ZVRpbWU6IHNlbER0LAogICAgICAgIGNvdW50RG93bjogewogICAgICAgICAgZGF5czogIjAiLAogICAgICAgICAgaG91cnM6ICIwMCIsCiAgICAgICAgICBtaW5zOiAiMDAiLAogICAgICAgICAgc2Vjb25kczogIjAwIiwKICAgICAgICB9LAogICAgICAgIHRpbWVyOiBudWxsLAogICAgICAgIGlzT3ZlcjogZmFsc2UsCiAgICAgIH0pOwogICAgICB0aGlzLmNvdW50RG93bigpOwogICAgICB0aGlzLmFkZERhdGUgPSAiIjsKICAgIH0sCiAgICBjb3VudERvd24oKSB7CiAgICAgIGxldCBjdXJUaW1lID0gRGF0ZS5ub3coKTsKICAgICAgdGhpcy5kYXRlVGltZS5tYXAoaXRlbSA9PiB7CiAgICAgICAgaXRlbS5jdXJUaW1lID0gY3VyVGltZTsKICAgICAgICBsZXQgZHRUaW1lID0gbmV3IERhdGUoaXRlbS5lbmREYXRlVGltZSkuZ2V0VGltZSgpOwogICAgICAgIGlmIChkdFRpbWUgLSBjdXJUaW1lIDwgMCkgaXRlbS5pc092ZXIgPSB0cnVlOwogICAgICAgIGNvbnN0IHRpbWUgPSBNYXRoLnJvdW5kKChkdFRpbWUgLSBjdXJUaW1lKSAvIDEwMDApCiAgICAgICAgdGhpcy5nZXRUaW1lKGl0ZW0sIHRpbWUpOwogICAgICB9KQogICAgfSwKICAgIGdldFRpbWUoZHQsIHRpbWUpIHsKICAgICAgZHQudGltZXIgJiYgY2xlYXJJbnRlcnZhbChkdC50aW1lcik7CiAgICAgIGlmICh0aW1lIDwgMCkgewogICAgICAgIGR0LmlzT3ZlciA9IHRydWU7CiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgY29uc3QgeyBkZCwgaGgsIG1tLCBzcyB9ID0gdGhpcy5kdXJhdGlvbkZvcm1hdHRlcih0aW1lKTsKICAgICAgZHQuY291bnREb3duLmRheXMgPSBkZCB8fCAwOwogICAgICAvLyBkdC5jb3VudERvd24uaG91cnMgPSBgMDAke2hoIHx8ICcnfWAuc2xpY2UoLTIpOwogICAgICAvLyBkdC5jb3VudERvd24ubWlucyA9IGAwMCR7bW0gfHwgJyd9YC5zbGljZSgtMik7CiAgICAgIC8vIGR0LmNvdW50RG93bi5zZWNvbmRzID0gYDAwJHtzcyB8fCAnJ31gLnNsaWNlKC0yKTsKICAgICAgZHQuY291bnREb3duLmhvdXJzID0gaGggfHwgMDsKICAgICAgZHQuY291bnREb3duLm1pbnMgPSBtbSB8fCAwOwogICAgICBkdC5jb3VudERvd24uc2Vjb25kcyA9IHNzIHx8IDA7CiAgICAgIGR0LnRpbWVyID0gc2V0VGltZW91dChfID0+IHsKICAgICAgICBsZXQgY3VyVGltZSA9IERhdGUubm93KCk7CiAgICAgICAgbGV0IGR0VGltZSA9IG5ldyBEYXRlKGR0LmVuZERhdGVUaW1lKS5nZXRUaW1lKCk7CiAgICAgICAgY29uc3QgZGlmZmVyZW5jZVRpbWUgPSBNYXRoLnJvdW5kKChkdFRpbWUgLSBjdXJUaW1lKSAvIDEwMDApCiAgICAgICAgdGhpcy5nZXRUaW1lKGR0LCBkaWZmZXJlbmNlVGltZSk7CiAgICAgIH0sIDEwMDApCgogICAgfSwKICAgIGR1cmF0aW9uRm9ybWF0dGVyKHRpbWUpIHsKICAgICAgaWYgKCF0aW1lKSByZXR1cm4geyBzczogMCB9OwogICAgICBsZXQgdCA9IHRpbWU7CiAgICAgIGNvbnN0IHNzID0gdCAlIDYwOwogICAgICB0ID0gKHQgLSBzcykgLyA2MDsKICAgICAgaWYgKHQgPCAxKSByZXR1cm4geyBzcyB9OwogICAgICBjb25zdCBtbSA9IHQgJSA2MDsKICAgICAgdCA9ICh0IC0gbW0pIC8gNjA7CiAgICAgIGlmICh0IDwgMSkgcmV0dXJuIHsgbW0sIHNzIH07CiAgICAgIGNvbnN0IGhoID0gdCAlIDI0OwogICAgICB0ID0gKHQgLSBoaCkgLyAyNDsKICAgICAgaWYgKHQgPCAxKSByZXR1cm4geyBoaCwgbW0sIHNzIH07CiAgICAgIGNvbnN0IGRkID0gdDsKICAgICAgcmV0dXJuIHsgZGQsIGhoLCBtbSwgc3MgfTsKICAgIH0KICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/basis/countDown","sourcesContent":["<template>\n  <div class=\"count-down\">\n    <div class=\"add-datetime\">\n      <el-date-picker v-model=\"addDate\" type=\"datetime\" :picker-options=\"pickerOptions\" placeholder=\"选择时间倒计时\"></el-date-picker>\n      <el-button type=\"primary\" @click=\"addDatetime\" style=\"margin-left: 10px;\">添加</el-button>\n      <span style=\"margin-left: 20px;\">当前时间：{{nowDate}}</span>\n    </div>\n    <div class=\"dt-con\">\n      <div class=\"dt-list\" v-for=\"(d, i) in dateTime\" :key=\"i\" :class=\"[setTimerClass(d)]\">\n        <p class=\"dt-datetime\">结束时间：{{d.endDateTime}} <span v-if=\"d.isOver\" class=\"dt-datetime-over\">已结束</span></p>\n        <div class=\"dt-progress dt-day\">\n          <el-progress type=\"circle\" :percentage=\"Number((d.countDown.days/30*100).toFixed(2))\" :width=\"80\" :show-text=\"false\"></el-progress>\n          <div class=\"dt-cd\">{{d.countDown.days}}天</div>\n        </div>\n        <div class=\"dt-progress dt-hours\">\n          <el-progress type=\"circle\" :percentage=\"Number((d.countDown.hours/24*100).toFixed(2))\" :width=\"80\" :show-text=\"false\"></el-progress>\n          <div class=\"dt-cd\">{{d.countDown.hours}}时</div>\n        </div>\n        <div class=\"dt-progress dt-mins\">\n          <el-progress type=\"circle\" :percentage=\"Number((d.countDown.mins/60*100).toFixed(2))\" :width=\"80\" :show-text=\"false\"></el-progress>\n          <div class=\"dt-cd\">{{d.countDown.mins}}分</div>\n        </div>\n        <div class=\"dt-progress dt-seconds\">\n          <el-progress type=\"circle\" :percentage=\"Number((d.countDown.seconds/60*100).toFixed(2))\" :width=\"80\" :show-text=\"false\"></el-progress>\n          <div class=\"dt-cd\">{{d.countDown.seconds}}秒</div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"countDown\",\n  components: {\n\n  },\n  data() {\n    return {\n      addDate: \"\",\n      nowDate: \"\",\n      pickerOptions: {\n        disabledDate(date) {\n          return date.getTime() < Date.now() - 24 * 60 * 60 * 1000 || date.getTime() > Date.now() + 30 * 24 * 60 * 60 * 1000\n        }\n      },\n      dateTime: [{\n        endDateTime: \"2023-01-22 00:00:00\",\n        countDown: { days: \"0\", hours: \"00\", mins: \"00\", seconds: \"00\", },\n        timer: null,\n        isOver: false,\n        curTime: 0,\n      }],\n    }\n  },\n  created() { },\n  mounted() {\n    this.countDown();\n    setInterval(() => {\n      let nd = new Date();\n      let y = nd.getFullYear();\n      let m = `00${nd.getMonth() + 1}`.slice(-2);\n      let d = `00${nd.getDate()}`.slice(-2);\n      let h = `00${nd.getHours()}`.slice(-2);\n      let ms = `00${nd.getMinutes()}`.slice(-2);\n      let s = `00${nd.getSeconds()}`.slice(-2);\n      this.nowDate = y + \"-\" + m + \"-\" + d + \" \" + h + \":\" + ms + \":\" + s\n    }, 1000);\n  },\n  computed: {\n    setTimerClass() {\n      return (dt) => {\n        let dtClass = '';\n        if (!dt.countDown.days && !dt.countDown.hours && !dt.countDown.mins && !dt.countDown.seconds) dtClass = 'dt-over';\n        else if (!dt.countDown.days && !dt.countDown.hours && !dt.countDown.mins && dt.countDown.seconds) dtClass = 'mins-over';\n        else if (!dt.countDown.days && !dt.countDown.hours && (dt.countDown.mins || dt.countDown.seconds)) dtClass = 'hours-over';\n        else if (!dt.countDown.days && (dt.countDown.hours || dt.countDown.mins || dt.countDown.seconds)) dtClass = 'days-over';\n        return dtClass;\n      }\n    }\n  },\n  methods: {\n    addDatetime() {\n      if (!this.addDate) return\n      let selDt = new Date(this.addDate).format(\"yyyy-MM-dd HH:mm:ss\")\n      if ((new Date(selDt).getTime()) - (Date.now()) < 30000) {\n        this.$message.warning(\"倒计时时间不能小于 30 秒\");\n        return;\n      }\n      this.dateTime.push({\n        endDateTime: selDt,\n        countDown: {\n          days: \"0\",\n          hours: \"00\",\n          mins: \"00\",\n          seconds: \"00\",\n        },\n        timer: null,\n        isOver: false,\n      });\n      this.countDown();\n      this.addDate = \"\";\n    },\n    countDown() {\n      let curTime = Date.now();\n      this.dateTime.map(item => {\n        item.curTime = curTime;\n        let dtTime = new Date(item.endDateTime).getTime();\n        if (dtTime - curTime < 0) item.isOver = true;\n        const time = Math.round((dtTime - curTime) / 1000)\n        this.getTime(item, time);\n      })\n    },\n    getTime(dt, time) {\n      dt.timer && clearInterval(dt.timer);\n      if (time < 0) {\n        dt.isOver = true;\n        return\n      }\n      const { dd, hh, mm, ss } = this.durationFormatter(time);\n      dt.countDown.days = dd || 0;\n      // dt.countDown.hours = `00${hh || ''}`.slice(-2);\n      // dt.countDown.mins = `00${mm || ''}`.slice(-2);\n      // dt.countDown.seconds = `00${ss || ''}`.slice(-2);\n      dt.countDown.hours = hh || 0;\n      dt.countDown.mins = mm || 0;\n      dt.countDown.seconds = ss || 0;\n      dt.timer = setTimeout(_ => {\n        let curTime = Date.now();\n        let dtTime = new Date(dt.endDateTime).getTime();\n        const differenceTime = Math.round((dtTime - curTime) / 1000)\n        this.getTime(dt, differenceTime);\n      }, 1000)\n\n    },\n    durationFormatter(time) {\n      if (!time) return { ss: 0 };\n      let t = time;\n      const ss = t % 60;\n      t = (t - ss) / 60;\n      if (t < 1) return { ss };\n      const mm = t % 60;\n      t = (t - mm) / 60;\n      if (t < 1) return { mm, ss };\n      const hh = t % 24;\n      t = (t - hh) / 24;\n      if (t < 1) return { hh, mm, ss };\n      const dd = t;\n      return { dd, hh, mm, ss };\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.count-down {\n  margin-top: 30px;\n  margin-left: 30px;\n  .dt-con {\n    width: 900px;\n\n    .dt-list {\n      display: inline-block;\n      margin: 20px 20px 0 0;\n      border: 1px solid #ebeef5;\n      padding: 10px;\n      width: 400px;\n      border-radius: 8px;\n      box-shadow: 0 2px 20px -4px rgba(0, 0, 0, 0.1);\n\n      .dt-datetime {\n        margin-bottom: 10px;\n        .dt-datetime-over {\n          margin-left: 20px;\n        }\n      }\n      .dt-progress {\n        position: relative;\n        margin-right: 10px;\n        display: inline-block;\n\n        .el-progress {\n          display: block;\n          transform: rotateY(180deg);\n        }\n        .dt-cd {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          color: #606266;\n          font-size: 14px;\n        }\n      }\n    }\n    .dt-over {\n      border: 1px solid rgba(255, 73, 73, 0.1);\n      box-shadow: 0 2px 20px -4px rgba(255, 73, 73, 0.1);\n    }\n    .dt-over .dt-datetime,\n    .dt-over .dt-progress .dt-cd,\n    .days-over .dt-day .dt-cd,\n    .hours-over .dt-day .dt-cd,\n    .hours-over .dt-hours .dt-cd,\n    .mins-over .dt-day .dt-cd,\n    .mins-over .dt-hours .dt-cd,\n    .mins-over .dt-mins .dt-cd {\n      color: #ff4949;\n    }\n  }\n}\n</style>\n"]}]}