{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\1\\预见未来后台管理系统\\后台\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\Administrator\\Desktop\\1\\预见未来后台管理系统\\后台\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\1\\预见未来后台管理系统\\后台\\src\\store\\modules\\routes.js","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\1\\预见未来后台管理系统\\后台\\src\\store\\modules\\routes.js","mtime":1656935525841},{"path":"C:\\Users\\Administrator\\Desktop\\1\\预见未来后台管理系统\\后台\\babel.config.js","mtime":1646805521000},{"path":"C:\\Users\\Administrator\\Desktop\\1\\预见未来后台管理系统\\后台\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\1\\预见未来后台管理系统\\后台\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\1\\预见未来后台管理系统\\后台\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CgovKioKICog55m75b2V5ZCO6Lev55Sx5p2D6ZmQ6K6+572uCiAqLwppbXBvcnQgeyBhc3luY1JvdXRlcywgYmFzZVJvdXRlcyB9IGZyb20gIkAvcm91dGVyIjsKaW1wb3J0IHsgZ2V0Um9sZUJ5TWVudSB9IGZyb20gJ0AvYXBpL3JvbGUnOwovKioKICog6YCS5b2S6Lev55Sx77yM6L+U5Zue56ym5ZCI6KeS6Imy5p2D6ZmQ55qE6Lev55SxCiAqIEBwYXJhbSB7QXJyYXl9IGFzeW5jUm91dGVyQWxsIOaJgOaciei3r+eUsQogKiBAcGFyYW0ge0FycmF5fSByb2xlUGVyIOinkuiJsuadg+mZkOi3r+eUsQogKi8KCmZ1bmN0aW9uIGZpbHRlckFzeW5jUm91dGVyKGFzeW5jUm91dGVyQWxsLCByb2xlUGVyKSB7CiAgdmFyIGFjY2Vzc2VkUm91dGVycyA9IGFzeW5jUm91dGVyQWxsLmZpbHRlcihmdW5jdGlvbiAocm9sZSkgewogICAgaWYgKHJvbGUubWV0YSAmJiByb2xlLm1ldGEucGVybWlzc2lvbnMgJiYgcm9sZVBlci5pbmRleE9mKHJvbGUubWV0YS5wZXJtaXNzaW9ucykgIT09IC0xKSB7CiAgICAgIGlmIChyb2xlLmNoaWxkcmVuICYmIHJvbGUuY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgcm9sZS5jaGlsZHJlbiA9IGZpbHRlckFzeW5jUm91dGVyKHJvbGUuY2hpbGRyZW4sIHJvbGVQZXIpOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfSk7CiAgcmV0dXJuIGFjY2Vzc2VkUm91dGVyczsKfQoKdmFyIHN0YXRlID0gewogIHJvdXRlcnM6IFtdLAogIC8v5omA5pyJ6Lev55SxCiAgYWRkUm91dGVyczogW10gLy/mnYPpmZDov4fmu6Tot6/nlLEKCn07CnZhciBtdXRhdGlvbnMgPSB7CiAgU0VUX1JPVVRFUlM6IGZ1bmN0aW9uIFNFVF9ST1VURVJTKHN0YXRlLCByb3V0ZXJzKSB7CiAgICBzdGF0ZS5yb3V0ZXJzID0gYmFzZVJvdXRlcy5jb25jYXQocm91dGVycyk7IC8vIOaAu+i3r+eUsQoKICAgIHN0YXRlLmFkZFJvdXRlcnMgPSByb3V0ZXJzOyAvLyDmnYPpmZDot6/nlLEKICB9Cn07CnZhciBhY3Rpb25zID0gewogIC8vIOagueaNruinkuiJsu+8jOmHjeaWsOiuvue9ruadg+mZkOi3r+eUsTvlubbkv53lrZjliLB2dWV45LitLFNFVF9ST1VURVJTOwogIGdlbmVyYXRlUm91dGVzOiBmdW5jdGlvbiBnZW5lcmF0ZVJvdXRlcyhfcmVmLCBkYXRhKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgdmFyIHJvbGVzID0gZGF0YS5yb2xlczsgLy8g5qC55o2u6KeS6Imy6I635Y+W5p2D6ZmQCgogICAgICBnZXRSb2xlQnlNZW51KHsKICAgICAgICByb2xlczogcm9sZXMKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgdmFyIGFjY2Vzc2VkUm91dGVycyA9ICcnOwoKICAgICAgICBpZiAocm9sZXMuaW5kZXhPZignYWRtaW4nKSA+PSAwKSB7CiAgICAgICAgICAvLyDlpoLmnpzmmK/nrqHnkIblkZjvvIznm7TmjqXlsIbmnYPpmZDot6/nlLHotYvlgLznu5nmlrDot6/nlLE7CiAgICAgICAgICBhY2Nlc3NlZFJvdXRlcnMgPSBhc3luY1JvdXRlczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8g6Z2e566h55CG5ZGY55So5oi3LOWmgnJvbGVzOlsnZWRpdG9yJywnZGV2ZWxvcGVyJ13vvIzliJnpnIDopoHov4fmu6TmnYPpmZDot6/nlLHmlbDmja4KICAgICAgICAgIGFjY2Vzc2VkUm91dGVycyA9IGZpbHRlckFzeW5jUm91dGVyKGFzeW5jUm91dGVzLCByZXMuZGF0YSk7CiAgICAgICAgICBhY2Nlc3NlZFJvdXRlcnMudW5zaGlmdChhc3luY1JvdXRlc1swXSk7CiAgICAgICAgfQoKICAgICAgICBjb21taXQoJ1NFVF9ST1VURVJTJywgYWNjZXNzZWRSb3V0ZXJzKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgc3RhdGU6IHN0YXRlLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGFjdGlvbnM6IGFjdGlvbnMKfTs="},{"version":3,"sources":["C:/Users/Administrator/Desktop/1/预见未来后台管理系统/后台/src/store/modules/routes.js"],"names":["asyncRoutes","baseRoutes","getRoleByMenu","filterAsyncRouter","asyncRouterAll","rolePer","accessedRouters","filter","role","meta","permissions","indexOf","children","length","state","routers","addRouters","mutations","SET_ROUTERS","concat","actions","generateRoutes","data","commit","Promise","resolve","roles","then","res","unshift","catch","error","reject"],"mappings":";;;;AAAA;AACA;AACA;AAEA,SACCA,WADD,EAECC,UAFD,QAGO,UAHP;AAIA,SACCC,aADD,QAEO,YAFP;AAKA;AACA;AACA;AACA;AACA;;AACA,SAASC,iBAAT,CAA2BC,cAA3B,EAA2CC,OAA3C,EAAoD;AACnD,MAAIC,eAAe,GAAGF,cAAc,CAACG,MAAf,CAAsB,UAAAC,IAAI,EAAI;AACnD,QAAIA,IAAI,CAACC,IAAL,IAAaD,IAAI,CAACC,IAAL,CAAUC,WAAvB,IAAsCL,OAAO,CAACM,OAAR,CAAgBH,IAAI,CAACC,IAAL,CAAUC,WAA1B,MAA2C,CAAC,CAAtF,EAAyF;AACxF,UAAIF,IAAI,CAACI,QAAL,IAAiBJ,IAAI,CAACI,QAAL,CAAcC,MAAnC,EAA2C;AAC1CL,QAAAA,IAAI,CAACI,QAAL,GAAgBT,iBAAiB,CAACK,IAAI,CAACI,QAAN,EAAgBP,OAAhB,CAAjC;AACA;;AACD,aAAO,IAAP;AACA;;AACD,WAAO,KAAP;AACA,GARqB,CAAtB;AASA,SAAOC,eAAP;AACA;;AAED,IAAMQ,KAAK,GAAG;AACbC,EAAAA,OAAO,EAAE,EADI;AACA;AACbC,EAAAA,UAAU,EAAE,EAFC,CAEG;;AAFH,CAAd;AAKA,IAAMC,SAAS,GAAG;AACjBC,EAAAA,WAAW,EAAE,qBAACJ,KAAD,EAAQC,OAAR,EAAoB;AAChCD,IAAAA,KAAK,CAACC,OAAN,GAAgBd,UAAU,CAACkB,MAAX,CAAkBJ,OAAlB,CAAhB,CADgC,CACW;;AAC3CD,IAAAA,KAAK,CAACE,UAAN,GAAmBD,OAAnB,CAFgC,CAEL;AAC3B;AAJgB,CAAlB;AAOA,IAAMK,OAAO,GAAG;AACf;AACAC,EAAAA,cAFe,gCAIZC,IAJY,EAIN;AAAA,QADRC,MACQ,QADRA,MACQ;AACR,WAAO,IAAIC,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC7B,UAAIC,KAAK,GAAGJ,IAAI,CAACI,KAAjB,CAD6B,CAE7B;;AACAxB,MAAAA,aAAa,CAAC;AACbwB,QAAAA,KAAK,EAAEA;AADM,OAAD,CAAb,CAEGC,IAFH,CAEQ,UAAAC,GAAG,EAAI;AACd,YAAItB,eAAe,GAAG,EAAtB;;AACA,YAAIoB,KAAK,CAACf,OAAN,CAAc,OAAd,KAA0B,CAA9B,EAAiC;AAChC;AACAL,UAAAA,eAAe,GAAGN,WAAlB;AACA,SAHD,MAGO;AACN;AACAM,UAAAA,eAAe,GAAGH,iBAAiB,CAACH,WAAD,EAAc4B,GAAG,CAACN,IAAlB,CAAnC;AACAhB,UAAAA,eAAe,CAACuB,OAAhB,CAAwB7B,WAAW,CAAC,CAAD,CAAnC;AACA;;AACDuB,QAAAA,MAAM,CAAC,aAAD,EAAgBjB,eAAhB,CAAN;AACAmB,QAAAA,OAAO;AACP,OAdD,EAcGK,KAdH,CAcS,UAAAC,KAAK,EAAI;AACjBC,QAAAA,MAAM,CAACD,KAAD,CAAN;AACA,OAhBD;AAiBA,KApBM,CAAP;AAqBA;AA1Bc,CAAhB;AA6BA,eAAe;AACdjB,EAAAA,KAAK,EAALA,KADc;AAEdG,EAAAA,SAAS,EAATA,SAFc;AAGdG,EAAAA,OAAO,EAAPA;AAHc,CAAf","sourcesContent":["/**\n * 登录后路由权限设置\n */\n\nimport {\n\tasyncRoutes,\n\tbaseRoutes\n} from \"@/router\";\nimport {\n\tgetRoleByMenu\n} from '@/api/role'\n\n\n/**\n * 递归路由，返回符合角色权限的路由\n * @param {Array} asyncRouterAll 所有路由\n * @param {Array} rolePer 角色权限路由\n */\nfunction filterAsyncRouter(asyncRouterAll, rolePer) {\n\tlet accessedRouters = asyncRouterAll.filter(role => {\n\t\tif (role.meta && role.meta.permissions && rolePer.indexOf(role.meta.permissions) !== -1) {\n\t\t\tif (role.children && role.children.length) {\n\t\t\t\trole.children = filterAsyncRouter(role.children, rolePer)\n\t\t\t}\n\t\t\treturn true\n\t\t}\n\t\treturn false;\n\t})\n\treturn accessedRouters;\n}\n\nconst state = {\n\trouters: [], //所有路由\n\taddRouters: [], //权限过滤路由\n}\n\nconst mutations = {\n\tSET_ROUTERS: (state, routers) => {\n\t\tstate.routers = baseRoutes.concat(routers) // 总路由\n\t\tstate.addRouters = routers // 权限路由\n\t}\n}\n\nconst actions = {\n\t// 根据角色，重新设置权限路由;并保存到vuex中,SET_ROUTERS;\n\tgenerateRoutes({\n\t\tcommit\n\t}, data) {\n\t\treturn new Promise(resolve => {\n\t\t\tlet roles = data.roles;\n\t\t\t// 根据角色获取权限\n\t\t\tgetRoleByMenu({\n\t\t\t\troles: roles\n\t\t\t}).then(res => {\n\t\t\t\tlet accessedRouters = '';\n\t\t\t\tif (roles.indexOf('admin') >= 0) {\n\t\t\t\t\t// 如果是管理员，直接将权限路由赋值给新路由;\n\t\t\t\t\taccessedRouters = asyncRoutes\n\t\t\t\t} else {\n\t\t\t\t\t// 非管理员用户,如roles:['editor','developer']，则需要过滤权限路由数据\n\t\t\t\t\taccessedRouters = filterAsyncRouter(asyncRoutes, res.data)\n\t\t\t\t\taccessedRouters.unshift(asyncRoutes[0]);\n\t\t\t\t}\n\t\t\t\tcommit('SET_ROUTERS', accessedRouters)\n\t\t\t\tresolve()\n\t\t\t}).catch(error => {\n\t\t\t\treject(error);\n\t\t\t})\n\t\t})\n\t}\n}\n\nexport default {\n\tstate,\n\tmutations,\n\tactions\n};"]}]}