{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\预见未来后台管理系统\\后台\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\预见未来后台管理系统\\后台\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\Administrator\\Desktop\\预见未来后台管理系统\\后台\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\预见未来后台管理系统\\后台\\src\\views\\authority\\role\\components\\setRole.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\预见未来后台管理系统\\后台\\src\\views\\authority\\role\\components\\setRole.vue","mtime":1652153987430},{"path":"C:\\Users\\Administrator\\Desktop\\预见未来后台管理系统\\后台\\babel.config.js","mtime":1646805521000},{"path":"C:\\Users\\Administrator\\Desktop\\预见未来后台管理系统\\后台\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\预见未来后台管理系统\\后台\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Administrator\\Desktop\\预见未来后台管理系统\\后台\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\预见未来后台管理系统\\后台\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L1VzZXJzL0FkbWluaXN0cmF0b3IvRGVza3RvcC9cdTk4ODRcdTg5QzFcdTY3MkFcdTY3NjVcdTU0MEVcdTUzRjBcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYvXHU1NDBFXHU1M0YwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgZ2V0TWVudU9wZXJhdGUgYXMgX2dldE1lbnVPcGVyYXRlLCBzZXRSb2xlUGVybWlzc2lvbnMgYXMgX3NldFJvbGVQZXJtaXNzaW9ucyB9IGZyb20gIkAvYXBpL3JvbGUiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogInNldFJvbGUiLAogIGNvbXBvbmVudHM6IHt9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkZWZhdWx0UHJvcHM6IHsKICAgICAgICBjaGlsZHJlbjogImNoaWxkcmVuIiwKICAgICAgICBsYWJlbDogInRpdGxlIgogICAgICB9LAogICAgICBkcmF3ZXI6IGZhbHNlLAogICAgICByb2xlSW5mbzoge30sCiAgICAgIHRyZWVNZW51OiBbXSwKICAgICAgdHJlZUNoZWNrZWRLZXlzOiBbXQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7Ly8gY29uc29sZS5sb2codGhpcy50cmVlTWVudSk7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkge30sCiAgbWV0aG9kczogewogICAgc2hvdzogZnVuY3Rpb24gc2hvdyhyb3cpIHsKICAgICAgdGhpcy5yb2xlSW5mbyA9IHJvdzsKICAgICAgdGhpcy5nZXRNZW51T3BlcmF0ZShyb3cubmFtZSk7CiAgICB9LAogICAgY2xvc2U6IGZ1bmN0aW9uIGNsb3NlKCkgewogICAgICB0aGlzLiRyZWZzLm1lbnVUcmVlLnNldENoZWNrZWRLZXlzKFtdKTsKICAgIH0sCiAgICBjaGFuZ2VSb2xlOiBmdW5jdGlvbiBjaGFuZ2VSb2xlKCkgewogICAgICB2YXIgY2hlY2tlZEtleSA9IHRoaXMuJHJlZnMubWVudVRyZWUuZ2V0Q2hlY2tlZEtleXMoKTsgLy8gY29uc29sZS5sb2coY2hlY2tlZEtleSk7CgogICAgICB0aGlzLnNldFJvbGVQZXJtaXNzaW9ucyh0aGlzLnJvbGVJbmZvLm5hbWUsIGNoZWNrZWRLZXkpOwogICAgfSwKICAgIGdldE1lbnVPcGVyYXRlOiBmdW5jdGlvbiBnZXRNZW51T3BlcmF0ZShyb2xlTmFtZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgcmVzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIF9nZXRNZW51T3BlcmF0ZSh7CiAgICAgICAgICAgICAgICAgIHJvbGVOYW1lOiByb2xlTmFtZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLnRyZWVNZW51ID0gcmVzLmRhdGEubWVudVBlckxpc3Q7IC8vIGNvbnNvbGUubG9nKHRoaXMudHJlZU1lbnUpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMudHJlZUNoZWNrZWRLZXlzID0gcmVzLmRhdGEuY2hlY2tlZEtleXM7IC8vIGNvbnNvbGUubG9nKHRoaXMudHJlZUNoZWNrZWRLZXlzKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzLmRyYXdlciA9IHRydWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBzZXRSb2xlUGVybWlzc2lvbnM6IGZ1bmN0aW9uIHNldFJvbGVQZXJtaXNzaW9ucyhyb2xlTmFtZSwgY2hlY2tlZEtleSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciByZXM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBfc2V0Um9sZVBlcm1pc3Npb25zKHsKICAgICAgICAgICAgICAgICAgcm9sZU5hbWU6IHJvbGVOYW1lLAogICAgICAgICAgICAgICAgICBjaGVja2VkS2V5OiBjaGVja2VkS2V5CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMi4kbWVzc2FnZS5zdWNjZXNzKCLmnYPpmZDorr7nva7miJDlip8iKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMi5kcmF3ZXIgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8g6IqC54K56KKr54K55Ye7CiAgICBjaGVja0NoYW5nZTogZnVuY3Rpb24gY2hlY2tDaGFuZ2UoZGF0YSwgY2hlY2tlZCwgaW5kZXRlcm1pbmF0ZSkgewogICAgICB2YXIgY2hlY2tlZEtleSA9IHRoaXMuJHJlZnMubWVudVRyZWUuZ2V0Q2hlY2tlZEtleXMoKTsKCiAgICAgIGlmIChjaGVja2VkKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coY2hlY2tlZCk7CiAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7CiAgICAgICAgdmFyIHNlYXJjaElkID0gZGF0YS5pZC5zdWJzdHJpbmcoMCwgNSkgKyAiMDAxIjsKCiAgICAgICAgaWYgKGNoZWNrZWRLZXkuaW5kZXhPZihzZWFyY2hJZCkgPT0gLTEpIHsKICAgICAgICAgIGNoZWNrZWRLZXkucHVzaChzZWFyY2hJZCk7CiAgICAgICAgICB0aGlzLiRyZWZzLm1lbnVUcmVlLnNldENoZWNrZWRLZXlzKGNoZWNrZWRLZXkpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgc2VhcmNoUGFySWQgPSBkYXRhLmlkLnN1YnN0cmluZygwLCA1KTsKICAgICAgICB2YXIgc2VhcmNoTGFzdElkID0gZGF0YS5pZC5zdWJzdHJpbmcoNSk7CiAgICAgICAgdmFyIHNlYXJjaFBhckZsYWcgPSBmYWxzZTsKICAgICAgICBjaGVja2VkS2V5Lm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgaWYgKGl0ZW0uc3Vic3RyaW5nKDAsIDUpID09IHNlYXJjaFBhcklkKSBzZWFyY2hQYXJGbGFnID0gdHJ1ZTsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKHNlYXJjaExhc3RJZCA9PSAiMDAxIiAmJiBzZWFyY2hQYXJGbGFnKSB7CiAgICAgICAgICBjaGVja2VkS2V5LnB1c2goZGF0YS5pZCk7CiAgICAgICAgICB0aGlzLiRyZWZzLm1lbnVUcmVlLnNldENoZWNrZWRLZXlzKGNoZWNrZWRLZXkpOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCLlvZPliY3oj5zljZXmnInlhbbku5bmk43kvZzvvIzkuI3og73lj5bmtojmn6Xor6LmnYPpmZAiKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"sources":["setRole.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"setRole\">\n    <el-drawer\n      :title=\"'【' + roleInfo.title + '】角色权限设置'\"\n      :visible.sync=\"drawer\"\n      direction=\"rtl\"\n      @closed=\"close\"\n      :size=\"600\"\n    >\n      <div class=\"clearflex\">\n        <!-- <el-button @click=\"close\">取 消</el-button> -->\n        <el-button type=\"primary\" @click=\"changeRole\">确 定</el-button>\n      </div>\n      <el-scrollbar style=\"height: calc(100% - 40px)\">\n        <div class=\"tree-menu\">\n          <el-tree\n            ref=\"menuTree\"\n            :data=\"treeMenu\"\n            :props=\"defaultProps\"\n            show-checkbox\n            :default-expand-all=\"true\"\n            node-key=\"id\"\n            :default-checked-keys=\"treeCheckedKeys\"\n            @check-change=\"checkChange\"\n          ></el-tree>\n        </div>\n      </el-scrollbar>\n    </el-drawer>\n  </div>\n</template>\n\n<script>\nimport { getMenuOperate, setRolePermissions } from \"@/api/role\";\nexport default {\n  name: \"setRole\",\n  components: {},\n  data() {\n    return {\n      defaultProps: {\n        children: \"children\",\n        label: \"title\",\n      },\n      drawer: false,\n      roleInfo: {},\n      treeMenu: [],\n      treeCheckedKeys: [],\n    };\n  },\n  created() {\n    // console.log(this.treeMenu);\n  },\n  mounted() {},\n  methods: {\n    show(row) {\n      this.roleInfo = row;\n      this.getMenuOperate(row.name);\n    },\n    close() {\n      this.$refs.menuTree.setCheckedKeys([]);\n    },\n    changeRole() {\n      let checkedKey = this.$refs.menuTree.getCheckedKeys();\n      // console.log(checkedKey);\n      this.setRolePermissions(this.roleInfo.name, checkedKey);\n    },\n\n    async getMenuOperate(roleName) {\n      let res = await getMenuOperate({ roleName: roleName });\n\n      if (res.status == 200) {\n        this.treeMenu = res.data.menuPerList;\n        // console.log(this.treeMenu);\n        this.treeCheckedKeys = res.data.checkedKeys;\n        // console.log(this.treeCheckedKeys);\n        this.drawer = true;\n      }\n    },\n    async setRolePermissions(roleName, checkedKey) {\n      let res = await setRolePermissions({\n        roleName: roleName,\n        checkedKey: checkedKey,\n      });\n      if (res.status == 200) {\n        this.$message.success(\"权限设置成功\");\n        this.drawer = false;\n      }\n    },\n    // 节点被点击\n    checkChange(data, checked, indeterminate) {\n      let checkedKey = this.$refs.menuTree.getCheckedKeys();\n      if (checked) {\n        // console.log(checked);\n        // console.log(data);\n        let searchId = data.id.substring(0, 5) + \"001\";\n        if (checkedKey.indexOf(searchId) == -1) {\n          checkedKey.push(searchId);\n          this.$refs.menuTree.setCheckedKeys(checkedKey);\n        }\n      } else {\n        let searchParId = data.id.substring(0, 5);\n        let searchLastId = data.id.substring(5);\n        let searchParFlag = false;\n        checkedKey.map((item) => {\n          if (item.substring(0, 5) == searchParId) searchParFlag = true;\n        });\n        if (searchLastId == \"001\" && searchParFlag) {\n          checkedKey.push(data.id);\n          this.$refs.menuTree.setCheckedKeys(checkedKey);\n          this.$message.warning(\"当前菜单有其他操作，不能取消查询权限\");\n        }\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n::v-deep {\n  .el-drawer__body {\n    overflow: auto;\n    overflow-y: hidden;\n  }\n  .el-scrollbar__wrap {\n    overflow-x: hidden;\n  }\n}\n.clearflex {\n  padding: 0 20px;\n  *zoom: 1;\n  text-align: right;\n}\n/deep/ .tree-menu {\n  padding: 20px;\n\n  .custom-tree-node {\n    display: flex;\n    justify-content: space-between;\n    width: 100%;\n    .menu-role {\n      flex: 1;\n      text-align: right;\n    }\n  }\n  .el-tree {\n    .el-tree-node__children {\n      .el-tree-node__children {\n        padding-left: 40px;\n        .el-tree-node {\n          display: inline-block;\n          .el-tree-node__content {\n            padding: 0 20px 0 0 !important;\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/views/authority/role/components"}]}